<ui:composition template="/WEB-INF/templates/layout.xhtml"
     xmlns="http://www.w3.org/1999/xhtml"
     xmlns:f="http://java.sun.com/jsf/core"
     xmlns:h="http://java.sun.com/jsf/html"
     xmlns:ui="http://java.sun.com/jsf/facelets"
     xmlns:p="http://primefaces.org/ui"
>
     <ui:define name="content">
         #{myBean.noLogged()}
         <h:form>
            <p:growl id="messages" showDetail="true" sticky="true" />
            <p:idleMonitor timeout="#{renderizador.tiempoMonitor}" >
                <p:ajax event="idle" onstart="PF('idleDialog').show()"      update="messages" />
            </p:idleMonitor>


            <p:confirmDialog 
                message="La sesión ha caducado,"
                header="Alto Rendimiento" severity="alert" widgetVar="idleDialog" closable="false" >
                        <p:commandLink value="Salir" update="msg"
                            oncomplete="idleDialog.hide()"
                            action="#{renderizador.cerrarSesion()}"  ajax="false"/>
                        
            </p:confirmDialog>
                      
        </h:form>
  
        
         <style>
            .menuSelect .ui-selectonemenu-label { 
                //background: pink;
               
                box-sizing: content-box!important;
            }
            .panel .ui-selectonemenu-list { 
                 //width: 100px;
                //background: green;
            }
            
            .ui-selectonemenu .ui-selectonemenu-trigger {
                  // background-color: red;
                width: auto!important;
            }
            .ui-state-highlight, .ui-widget-content .ui-state-highlight{
                background-image: linear-gradient(to bottom, #ffffff, #d6d6d6);
                background-color: #fff;
                color: #337ab7;
            }
            
            th{
                color: #FFFFFF!important;background-color: #373737!important;
                background-image: -webkit-gradient(linear, 0 0, 0 100%, from(#555), to(#373737))!important;
            }
            h2{
                font-family: Georgia, Times, "Times New Roman", serif; 
                font-size: 22px;
            }
            
            #comments input{
                
                padding-bottom: 0px!important;
            }
            #comments div{
                
                margin-bottom:  0px!important;
            }
            
            

         </style>
            <p:dialog header="Detalles" widgetVar="dlg1" id="dlg" modal="true" height="auto" width="auto">
                <h:form id="mensaje">
                    <h:outputText value="#{myBean.selectedEvent.evento}"/>
                    <p:growl id="messages" showDetail="true"  autoUpdate="true"/>
                    <h:panelGrid columns="2"  border="0" style="width: 100%;">
                        <h:outputText value="No. ENT. OFIC." />
                        <h:outputText value="#{myBean.selectedEvent.nument}"/>

                        <h:outputText value="No. ATL." />
                        <h:outputText value="#{myBean.selectedEvent.numatl}"/>

                        <h:outputText value="No. Días" />
                        <h:outputText value="#{myBean.selectedEvent.numdias}"/>
                        
                    </h:panelGrid>
                    <h:panelGrid columns="2"  border="0" style="width: 100%;">
                        <h:outputText value="" />
                        <h:outputText value="Total" />
                        <h:outputText value="ALOJAMIENTO" />
                        <h:outputText style="width: 15px;"  id="valojat" value="#{myBean.selectedEvent.valoja*myBean.selectedEvent.valojap*myBean.selectedEvent.valojad}"/>
                        <h:outputText value="ALIMENTACIÓN" />
                        <h:outputText style="width: 15px;"  id="valiment" value="#{myBean.selectedEvent.valimen*myBean.selectedEvent.valimenp*myBean.selectedEvent.valimend}"/>
                        <h:outputText value="HIDRATACIÓN" />
                        <h:outputText style="width: 15px;"  id="vhidrat" value="#{myBean.selectedEvent.vhidra*myBean.selectedEvent.vhidrap*myBean.selectedEvent.vhidrad}"/>
                        <h:outputText value="TRANSPORTE AEREO NACIONAL" />
                        <h:outputText style="width: 15px;"  id="vtransaereot" value="#{myBean.selectedEvent.vtransaereo*myBean.selectedEvent.vtransaereop*myBean.selectedEvent.vtransaereod}"/>
                        <h:outputText value="TRANSPORTE AEREO INTERNACIONAL" />
                        <h:outputText style="width: 15px;"  id="vtransaereointert" value="#{myBean.selectedEvent.vtransaereointer*myBean.selectedEvent.vtransaereointerp*myBean.selectedEvent.vtransaereointerd}"/>
                        <h:outputText value="EXCESOS EQUIPAJE" />
                        <h:outputText style="width: 15px;"  id="vexcequit" value="#{myBean.selectedEvent.vexcequi*myBean.selectedEvent.vexcequip*myBean.selectedEvent.vexcequid}"/>
                        <h:outputText value="TASAS AEROPUERTO - TARJETA DE ENTRADA" />
                        <h:outputText style="width: 15px;"  id="vtaxaereot" value="#{myBean.selectedEvent.vtaxaereo*myBean.selectedEvent.vtaxaereop*myBean.selectedEvent.vtaxaereod}"/>
                        <h:outputText value="SEGURO DE VIAJE" />
                        <h:outputText style="width: 15px;"  id="vsegviajet" value="#{myBean.selectedEvent.vsegviaje*myBean.selectedEvent.vsegviajep*myBean.selectedEvent.vsegviajed}"/>
                        <h:outputText value="TRANSPORTE INTERNO NACIONAL" />
                        <h:outputText style="width: 15px;"  id="vtransterrt" value="#{myBean.selectedEvent.vtransterr*myBean.selectedEvent.vtransterrp*myBean.selectedEvent.vtransterrd}"/>
                        <h:outputText value="TRANSPORTE INTERNO EXTRANJERO" />
                        <h:outputText style="width: 15px;"  id="vtransterrintert" value="#{myBean.selectedEvent.vtransterrinter*myBean.selectedEvent.vtransterrinterp*myBean.selectedEvent.vtransterrinterd}"/>
                        <h:outputText value="BONO DEPORTIVO INTERNACIONAL" />
                        <h:outputText style="width: 15px;"  id="vbonodept" value="#{myBean.selectedEvent.vbonodep*myBean.selectedEvent.vbonodepp*myBean.selectedEvent.vbonodepd}"/>
                        <h:outputText value="INSCRIPCIÓN" />
                        <h:outputText style="width: 15px;"  id="vinsct" value="#{myBean.selectedEvent.vinsc*myBean.selectedEvent.vinscp*myBean.selectedEvent.vinscd}"/>
                        <h:outputText value="VISA" />
                        <h:outputText style="width: 15px;"  id="vvisat" value="#{myBean.selectedEvent.vvisa*myBean.selectedEvent.vvisap*myBean.selectedEvent.vvisad}"/>
                        <h:outputText value="FONDO EMERGENCIA" />
                        <h:outputText style="width: 15px;"  id="vfondoemt" value="#{myBean.selectedEvent.vfondoem*myBean.selectedEvent.vfondoemp*myBean.selectedEvent.vfondoemd}"/>
                        <h:outputText value="TRADUCCIONES - COPIAS NOTARIADAS" />
                        <h:outputText style="width: 15px;"  id="tradextrast" value="#{myBean.selectedEvent.tradextras*myBean.selectedEvent.tradextrasp*myBean.selectedEvent.tradextrasd}"/>
                        <h:outputText value="GASTOS MOVIMIENTOS BANCARIOS" />
                        <h:outputText style="width: 15px;"  id="gastosbancat" value="#{myBean.selectedEvent.gastosbanca*myBean.selectedEvent.gastosbancap*myBean.selectedEvent.gastosbancad}"/>
                        <h:outputText value="REUNIONES - TALLERES" />
                        <h:outputText style="width: 15px;"  id="reuniotallert" value="#{myBean.selectedEvent.reuniotaller*myBean.selectedEvent.reuniotallerp*myBean.selectedEvent.reuniotallerd}"/>													 
                        <h:outputText value="ACTUALIZACIÓN DE CONOCIMIENTOS" />
                        <h:outputText style="width: 15px;"  id="actualizacionconot" value="#{myBean.selectedEvent.actualizacioncono*myBean.selectedEvent.actualizacionconop*myBean.selectedEvent.actualizacionconod}"/>													 
                        <h:outputText value="LICENCIAS Y MEMBRESÍAS" />
                        <h:outputText style="width: 15px;"  id="licenciast" value="#{myBean.selectedEvent.licencias*myBean.selectedEvent.licenciasp*myBean.selectedEvent.licenciasd}"/>													 
                        <h:outputText value="ESPECIFICOS DEPORTE" />
                        <h:outputText style="width: 15px;"  id="vespdept" value="#{myBean.selectedEvent.vespdep*myBean.selectedEvent.vespdepp*myBean.selectedEvent.vespdepd}"/>                                                                                    
                        <p:commandButton  value="Cerrar" icon="fa fa-times-circle"
                            style="color: #C8232C;"
                            styleClass="w3-btn botones"
                            onclick="PF('dlg1').hide()">
                        </p:commandButton>

                    </h:panelGrid>     
                </h:form>
            </p:dialog> 
         
         <div class="wrapper row3">
            <main class="clear"> 
                
				<nav id="mainavNO" class="fl_right">
                    <ul class="clear">
                      <li class="active">
                          <h:form>
                                            <p:commandButton  style="background: #4caf50; color: white;" value="Salir" action="#{myBean.logout()}" icon="fa fa-fw fa-external-link" />
                                        </h:form>
                      </li>
                    </ul>
                </nav>
                <div class="btmspace-80 center">
                  <h3 class="nospace">Bienvenidos</h3>
                  <h:outputText value="Usuario con acceso"/>
                </div>
             <!-- InstanceBeginEditable name="EditRegion1" -->
                 
                <h:outputLink value="javascript:void(0)" onclick="PF('dlg').show();" title="login">
                </h:outputLink>
                <p:growl id="growl" sticky="true" showDetail="true" life="3000" />
               
                    <h2>EVENTOS</h2>     
                    <div id="comments">
                        <ul>
                            <li>
                                <article>
                                    <header>
                                        <address><h2>EVENTOS GENERADOS POR #{myBean.currentUser.usuapellidos}</h2></address>
                                    </header>
                                    <div class="comcont">
                                        <div class="one_third first">
                                                        <label for="url"><B> Generar Nuevo Evento</B></label>
                                         </div>
                                         <h:form>
                                            <p:commandButton  style="background: #FF9800; color: white; float: right;" value="Regresar"
                                                            action="#{myBean.givmeLink(1)}" icon="fa fa-fw fa-undo" />
                                        </h:form>
                                        <p:commandButton id="gt000" 
                                                style=" background: #FBFBFB; color: black;" 
                                                value="Nuevo Evento" 
                                                onclick="PF('newEvent').show()" 
                                                icon="fa fa-fw fa-plus-circle"
                                                rendered="false"
                                                
                                                ></p:commandButton>  
                                        <p:commandButton id="gt" 
                                            style=" background: #FBFBFB; color: black;" 
                                            value="Nuevo Evento" 
                                            action="#{myBean.newEvento()}" 
                                            icon="fa fa-fw fa-plus-circle"
                                            
                                        ></p:commandButton> 
                                                  
                                    </div>
                                    <div class="comcont">
                                        <h:panelGrid id="panel-principal" style="margin-bottom: 100px;" columns="1">
                                            <h:form id="form-lista">
                                               
                                                <p:commandButton id="btn-generar" value="Generar Documento" icon="fa fa-fw fa-file" ajax="false">
                                                    <p:dataExporter type="pdf" target=":form-lista:all" fileName="#{myBean.selectFede.nombre}_eventos" 
                                                    
                                                    />
                                                </p:commandButton>
                                                <p:dataTable id="all" value="#{myBean.filtroEventos}" var="evento" style='font-size: 9px!important;    word-wrap: normal!important; table-layout: auto; text-align: center;'   rowIndexVar="index" 
                                                             selectionMode="single" selection="#{myBean.selectedEvent}" rowKey="#{evento.id}"
                                                             widgetVar="listaR" filteredValue="#{myBean.listaEventos}" emptyMessage="No hay registros..."
                                                             scrollable="true"
                                                >
                                                    
                                                    <p:ajax event="rowSelect" listener="#{myBean.onRowSelectEvento}" update=":dlg" oncomplete="PF('dlg1').show()" />
                                                    <p:ajax event="rowUnselect" listener="#{myBean.onRowUnselectEvento}" update=":dlg" />
                                                    <p:column width="100" headerText="Editar Evento">
                                                        <p:commandButton id="gt" 
                                                            style=" background: #F0BE10; color: white;" 
                                                            value="Editar" 
                                                            action="#{myBean.editEvent(evento)}"
                                                            icon="fa fa-fw fa-edit"

                                                
                                                        ></p:commandButton>  
                                                    </p:column>
                                                    <p:column width="120" filterBy="#{evento.evento}" headerText="Nombre del Evento"  filterMatchMode="contains">
                                                        <h:outputText value="#{evento.evento} " />
                                                    </p:column>
                                                    <p:column width="100" filterBy="#{evento.sede}" headerText="Sede Evento: Ciudad_Pais"  filterMatchMode="contains">
                                                        <h:outputText value="#{evento.sede}"/>
                                                    </p:column>
                                                    <p:column width="80" filterBy="#{evento.deporte}" headerText="Deporte"  filterMatchMode="contains">
                                                        <h:outputText value="#{evento.deporte}"/>
                                                    </p:column>
                                                    <p:column width="80" filterBy="#{evento.disciplina}" headerText="Disciplina"  filterMatchMode="contains">
                                                        <h:outputText value="#{evento.disciplina}"/>
                                                    </p:column>
                                                    <p:column  width="60" filterBy="#{evento.tipo}" headerText="Tipo"  filterMatchMode="contains">
                                                        <h:outputText  value="#{evento.tipo}"/>
                                                    </p:column>
                                                    <p:column width="60" filterBy="#{evento.fechai}" headerText="Fecha in" >
                                                         <f:facet name="filter">
                                                             <p:calendar pattern="yyyy-MM-dd"
                                                                navigator="true"
                                                                locale="es">
                                                                   <p:ajax event="dateSelect" oncomplete="PF('listaR').filter()" update="all" />
                                                                   <p:ajax event="change" oncomplete="PF('listaR').filter()" update="all"/>
                                                                </p:calendar>
                                                         </f:facet>
                                                        <p:outputLabel value="#{evento.fechai}">
                                                             <f:convertDateTime pattern="dd/MM/yyyy" />
                                                          </p:outputLabel>
                                                    </p:column>
                                                    <p:column width="60" filterBy="#{evento.fechaf}" headerText="Fecha fin" >
                                                         <f:facet name="filter">
                                                             <p:calendar pattern="yyyy-MM-dd"
                                                                navigator="true"
                                                                locale="es">
                                                                   <p:ajax event="dateSelect" oncomplete="PF('listaR').filter()" update="all" />
                                                                   <p:ajax event="change" oncomplete="PF('listaR').filter()" update="all"/>
                                                                </p:calendar>
                                                         </f:facet>
                                                        <p:outputLabel value="#{evento.fechaf}">
                                                             <f:convertDateTime pattern="dd/MM/yyyy" />
                                                          </p:outputLabel>
                                                    </p:column>
                                                    <p:column  width="50" filterBy="#{evento.nument}" headerText="No. Ent. Ofic."  
                                                               footerText="#{myBean.totalEntEventos}" filterMatchMode="contains">
                                                        <h:outputText  value="#{evento.nument}"/>
                                                    </p:column>
                                                    <p:column width="50" filterBy="#{evento.numatl}" headerText="No. ATL."  
                                                              footerText="#{myBean.totalAtlEventos}" filterMatchMode="contains">
                                                        <h:outputText  value="#{evento.numatl}"/>
                                                    </p:column>
                                                    <p:column width="50" filterBy="#{evento.numdias}" headerText="No. DIAS"  
                                                              footerText="#{myBean.totalDiasEventos}" filterMatchMode="contains">
                                                        <h:outputText  value="#{evento.numdias}"/>
                                                    </p:column>
                                                    
                                                    <p:column  width="80" filterBy="#{evento.total}" headerText="Valor Total" 
                                                               footerText="#{myBean.totalSumEventos}" filterMatchMode="contains">
                                                        <h:outputText  value="#{evento.total}"/>
                                                    </p:column>
                                                    <p:column width="80" filterBy="#{evento.sector}" headerText="Sector"  filterMatchMode="contains">
                                                        <h:outputText  value="#{evento.sector}"/>
                                                    </p:column>
                                                    <p:column width="100" filterBy="#{evento.aprobado}" headerText="Estado Evento" footerText="equals" filterMatchMode="equals">
                                                        <f:facet name="filter">
                                                            <p:selectOneButton onchange="PF('listaR').filter()" style="font-size: 8px;">
                                                                <f:converter converterId="javax.faces.Boolean" />
                                                                <f:selectItem itemLabel="T" itemValue="" />
                                                                <f:selectItem itemLabel="A" itemValue="true" />
                                                                <f:selectItem itemLabel="N" itemValue="false" />
                                                            </p:selectOneButton>
                                                        </f:facet>
                                                        <h:outputText value="#{evento.aprobado ? 'Aprobado': 'Negado'}" />
                                                    </p:column>
                                                    
                                                    
                                                    
                                                </p:dataTable>
                                            </h:form>
                                        </h:panelGrid>          
                                    </div>
                                </article>
                            </li>
                            <li>
                              <article>
                                    <div class="comcont">
                                       <div class="scrollable">
                                          <div id="datos"></div>
                                       </div>
                                    </div>
                              </article>
                            </li>
                        </ul>
                    </div>
                    <hr />
                 
                <script type="text/javascript">
                    function handleLoginRequest(xhr, status, args) {
                        if(args.validationFailed || !args.loggedIn) {
                            PF('dlg').jq.effect("shake", {times:5}, 100);
                            //location.reload(); 
                            //window.location.replace(window.location.href);
                        }
                        else {
                            PF('dlg').hide();
                            $('#loginLink').fadeOut();
                        }
                    }
                </script>
                  <!-- InstanceEndEditable -->
                <div class="clear"></div>
            </main>
        </div>
         
         <p:ajaxStatus onstart="PF('statusDialog').show()" onsuccess="PF('statusDialog').hide()" />
                                     <p:dialog id="dgl" widgetVar="statusDialog" modal="true" draggable="false" closable="false" resizable="false" showHeader="false">
                                         <h3>Procesando...</h3>
                                         <img  src="images/bar.gif"/>
                                     </p:dialog>
         
         <p:dialog id="modalNewEV" header="Añadir Número de delegaciones del Evento" widgetVar="newEvent" modal="true" draggable="false" >
              <p:growl id="growlA" sticky="true" showDetail="true" life="3000" />
              <p:messages id="messages" closable="true">
                    <p:effect type="puff" event="load" delay="300" />
                </p:messages>
                <h:outputText value="Añada el campo para crear el Evento." />
                <h:form id="nuevoForm">
                    <p:inputText value="#{myBean.delegacion}" 
                                id="dele" required="true" 
                                requiredMessage="Añada Número de delegaciones" placeholder="Delegaciones"
                                 converterMessage="Solo números"/>
                   <p:message for="dele" display="text"/>
                   <p:commandButton id="gtok" 
                        style=" background: #FBFBFB; color: black;" 
                        value="Nuevo Evento" 
                        action="#{myBean.newEvento()}" 
                        icon="fa fa-fw fa-plus-circle"
                        process="@form"
                        update="nuevoForm"
                    ></p:commandButton>  
                </h:form>
            </p:dialog>
     </ui:define>
</ui:composition>